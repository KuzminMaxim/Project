<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>User Info</title>
</head>
<body>
<th:block th:include="/_menu">..</th:block>
<h2>User Info Page</h2>
<h3>Welcome, <span th:utext="${#request.userPrincipal.name}">..</span></h3>
<img th:src="@{photo}" alt="Sorry, no photo "/>
<br/><br/>

<div th:if="${userInfo != null}">
    <a th:if="${#request.userPrincipal != null}" th:href="@{/changePassword}">Change password page</a>
    <a th:if="${#request.userPrincipal != null}" th:href="@{/setAvatar}">Set avatar</a>
    <a th:if="${#request.userPrincipal != null}" th:href="@{/uploadOneFile}">uploadOneFile</a>
</div>

<div th:if="${eventsWhereCreator != null}">
    <h3>Events created by me</h3>
    <form th:each="eventsWhereCreator : ${eventsWhereCreator}">
<table border="1">
    <tr>
        <th>Date of event creation</th>
        <th>Name of Event</th>
        <th>Description of event</th>
        <th>Date and time of event</th>
    </tr>
    <tr th:each="eventsWhereCreator : ${eventsWhereCreator}">
        <td th:utext="${eventsWhereCreator.eventDateOfCreation}">..</td>
        <td th:utext="${eventsWhereCreator.nameOfEvent}">..</td>
        <td th:utext="${eventsWhereCreator.eventDescription}">..</td>
        <td th:utext="${eventsWhereCreator.date}">..</td>
    </tr>
</table>
        <form th:each="eventsWhereCreator : ${eventsWhereCreator}" th:object="${eventForm}" method="post">
            <input type="hidden" th:name="nameOfEvent" th:value="${eventsWhereCreator.nameOfEvent}"/>
            <input type="submit"  th:formaction="deleteSomething" th:formmethod="post" value="Cancel this event">
        </form>
        <form th:each="eventsWhereCreator : ${eventsWhereCreator}" th:action="@{/openChat}" th:object="${chatForm}" method="post">
            <input type="hidden" th:name="chatName" th:value="${eventsWhereCreator.nameOfEvent}">
            <input type="submit" value="Chat">
        </form>
    </form>


</div>

<div th:if="${eventsWhereParticipant != null}">
    <h3>Events witch i joined</h3>
    <form th:each="eventsWhereParticipant : ${eventsWhereParticipant}">
<table border="1">
    <tr>
        <th>Date of event creation</th>
        <th>Name of Event</th>
        <th>Description of event</th>
        <th>Date and time of event</th>
    </tr>
    <tr th:each="eventsWhereParticipant : ${eventsWhereParticipant}">
        <td th:utext="${eventsWhereParticipant.eventDateOfCreation}">..</td>
        <td th:utext="${eventsWhereParticipant.nameOfEvent}">..</td>
        <td th:utext="${eventsWhereParticipant.eventDescription}">..</td>
        <td th:utext="${eventsWhereParticipant.date}">..</td>
    </tr>
</table>
        <form th:each="eventsWhereParticipant : ${eventsWhereParticipant}" th:object="${chatForm}">
            <input type="hidden" th:name="chatName" th:value="${eventsWhereParticipant.nameOfEvent}">
            <input type="submit" th:formaction="openChat" th:formmethod="post" value="Chat">
        </form>
        <form th:each="eventsWhereParticipant : ${eventsWhereParticipant}" th:object="${eventForm}" method="post">
            <input type="hidden" th:name="nameOfEvent" th:value="${eventsWhereParticipant.nameOfEvent}"/>
            <input type="hidden" th:name="eventParticipant" th:value="${#request.userPrincipal.name}"/>
            <input type="submit"  th:formaction="deleteParticipantFromEvent" th:formmethod="post" value="Exit from this event">
        </form>
    </form>
</div>

<div th:if="${cancelledChats != null}">
    <h3>Events that have been canceled</h3>
    <form th:each="cancelledChats : ${cancelledChats}">
        <table border="1">
            <tr>
                <th>Name of chat</th>
            </tr>
            <tr th:each="cancelledChats : ${cancelledChats}">
                <td th:utext="${cancelledChats.nameOfEvent}">..</td>
            </tr>
        </table>
        <form th:each="cancelledChats : ${cancelledChats}" th:object="${chatForm}">
            <input type="hidden" th:name="chatName" th:value="${cancelledChats.nameOfEvent}">
            <input type="submit" th:formaction="openChat" th:formmethod="post" value="Chat">
        </form>
        <form th:each="cancelledChats : ${cancelledChats}" th:object="${eventForm}" method="post">
            <input type="hidden" th:name="nameOfEvent" th:value="${cancelledChats.nameOfEvent}"/>
            <input type="hidden" th:name="eventParticipant" th:value="${#request.userPrincipal.name}"/>
            <input type="submit"  th:formaction="deleteParticipantFromEvent" th:formmethod="post" value="Exit from this chat">
        </form>
    </form>
</div>

</body>

</html>